function debounceRender(t){t.debounce&&window.cancelAnimationFrame(t.debounce),t.debounce=window.requestAnimationFrame(function(){t.render(),t.updated=!0})}function stringToHTML(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head&&e.head.childNodes&&e.head.childNodes.length>0&&Array.from(e.head.childNodes).reverse().forEach(function(t){e.body.insertBefore(t,e.body.firstChild)}),e.firstChild.lastChild.innerHTML}function dataHandler(t){return{get:function(e,r){return["object","array"].indexOf(trueTypeOf(e[r]))>-1?new Proxy(e[r],dataHandler(t)):e[r]},set:function(e,r,i){return e[r]===i||(e[r]=i,debounceRender(t),!0)}}}function makeProxy(t,e){var r="function"==typeof t.data?t.data():t.data;return new Proxy(r||{},dataHandler(e))}function trueTypeOf(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}let debug=!1;function setDebug(t){debug=!!t}function warn(){debug&&console.error("[DativeJs Warn]: ",arguments[0])}function tip(){console.warn("[DativeJs tips]: ",arguments[0])}var _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function each(t,e){var r=void 0,i=0;if(Array.isArray(t)){for(r=t.length;i<r;i++)if(!1===e.call(t[i],t[i],i))return t}else for(i in t)if(!1===e.call(t[i],t[i],i))return t;return t}function type(t){var e={},r=e.toString.call(t);return null==t?""+t:("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t){return e["[object "+t+"]"]=t.toLowerCase()}),"object"===(void 0===t?"undefined":_typeof$1(t))||"function"==typeof t?e[r]||"object":void 0===t?"undefined":_typeof$1(t))}function addClass(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(/\s+/).forEach(function(e){return t.classList.add(e)}):t.classList.add(e);else{var r=" "+(t.getAttribute("class")||"")+" ";r.indexOf(" "+e+" ")<0&&t.setAttribute("class",(r+e).trim())}}function removeClass(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(/\s+/).forEach(function(e){return t.classList.remove(e)}):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var r=" "+(t.getAttribute("class")||"")+" ",i=" "+e+" ";r.indexOf(i)>=0;)r=r.replace(i," ");(r=r.trim())?t.setAttribute("class",r):t.removeAttribute("class")}}var textInterpole=/\"((?:.|\n)+?)\"/g,textInterpole_=/\'((?:.|\n)+?)\'/g;function parsetext(text,opts,store){return text.replace(/\{\{((?:.|\n)+?)\}\}/g,function(match){var text$=match.slice(3,-3)||match.slice(2,-2);if(textInterpole.test(text$))return text$.replace(textInterpole,function(t,e){return e});if(textInterpole_.test(text$))return text$.replace(textInterpole_,function(t,e){return e});var sub=text$.split(".");if(sub.length>1){var temp=opts||store;return sub.forEach(function(item){if(!temp[item])return eval(item);temp=temp[item]}),temp}var self=opts;return self[text$]?self[text$]:eval(text$)})}var dif$$=function(t,e,r,i){if(t instanceof Node){var n=stringToHTML(e);t.innerHTML=parsetext(n,r,i)}else warn(typeof t+" not a Node")};function attributeparser(t,e){var r=e.split(".");if(r.length>1){var i=t;return r.forEach(function(t){i[t]&&(i=i[t])}),i}if(t[e])return t[e]}function Dative(t={}){"DOMParser"in window||warn("Your Browser Doesnt support DativeJs."),this instanceof Dative||warn("Dative Must be called as a constructor");this.options=t;var e=makeProxy(t,this);this.template=this.options.template,this.created=this.options.created,this.mounted=this.options.mounted,this.update=this.options.update,this.methods=this.options.methods,this.store=this.options.store,this.$ref={},this.debounce=null,this.updated=!1,Object.defineProperty(this,"data",{get:function(){return e},set:function(t){return e=new Proxy(t||{},dataHandler(this)),debounceRender(this),!0},configurable:!0}),void 0!==this.created&&null!==this.created&&this.created(),void 0!==this.mounted&&null!==this.mounted&&this.mounted();const r=this.options.computed;if(!r)return!1;for(let t in r){const e=r[t];"function"==typeof e&&Object.defineProperty(this.data,t,{get:e,enumerable:!0,configurable:!0})}this.render()}var clone=function(t){return JSON.parse(JSON.stringify(t))};function once(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}function checkType(t,e){return typeof t===e}function NotType(t,e){return typeof t!==e}function kebabToCamel(t,e={prefix:"",ignorePrefix:""}){const{prefix:r,ignorePrefix:i}=e;let n=t;null!=i&&""!==i&&(n=n.replace(new RegExp(`^${i}-`),""));const a=n.split("-").filter(t=>""!==t).reduce((t,e)=>t+=`${e[0].toUpperCase()}${e.slice(1)}`);return null!=r&&""!==r?`${r}${a.replace(/^([a-z])/,(t,e)=>e.toUpperCase())}`:a}Dative.prototype.set=function(t){for(var e in"object"!==trueTypeOf(t)&&warn("The provided data is not an object."),t)t.hasOwnProperty(e)&&(this.data[e]=t[e])},Dative.prototype.get=function(){return clone(this.data)},Dative.prototype.render=function(){this.options.target||this.options.el||warn("You did not provide a target for DativeJs");let t="function"===trueTypeOf(this.template)?this.template():this.template||`${document.querySelector('script[type="text/dative"]').innerHTML}`;this.options&&t||warn("You did not provide a template for this instance.");var e=this.options.target||this.options.el;this.elem="string"===trueTypeOf(e)?document.querySelector(`${e}`):e,e!=document.body&&"body"!=e&&e!=document.head&&"head"!=e||(this.elem.style.display="none",warn("Can't mount on <body> or <head>"));var r=this.elem;dif$$(r,t,this.data),Dative.emit(r,"render",this.data),void 0!==this.update&&null!==this.update&&this.updated&&this.update({data:this.data});for(const t of r.querySelectorAll("*"))for(const e of t.getAttributeNames())if(e.startsWith("@")){const r=e.slice(1),i=t.getAttribute(e);t.addEventListener(r,t=>this.methods[i].call(this,t)),t.removeAttribute(e)}else if(e.startsWith("on:")){const r=e.slice(3),i=t.getAttribute(e);t.addEventListener(r,t=>this.methods[i].call(this,t)),t.removeAttribute(e)}else if("ref"===e){const r=t.getAttribute(e);this.$ref[r]=t,t.removeAttribute(e)}else if(e.startsWith("on")){const r=t.getAttribute(e).split(":"),i=r[0],n=r[1];t.addEventListener(i,t=>this.methods[n].call(this,t)),t.removeAttribute(e)}else if(":show"===e){const r=t.getAttribute(e);t.style.display=attributeparser(this.data,r)?"block":"none",t.removeAttribute(e)}else if(":text"===e){const r=t.getAttribute(e);t.textContent=void 0===attributeparser(this.data,r)?"":attributeparser(this.data,r),t.removeAttribute(e)}else if(":value"===e){const r=t.getAttribute(e);t.value=void 0===attributeparser(this.data,r)?"":attributeparser(this.data,r),t.removeAttribute(e)}else if(":src"===e){const r=t.getAttribute(e);t.src=attributeparser(this.data,r),t.removeAttribute(e)}else if(":style"===e){const r=t.getAttribute(e);each(attributeparser(this.data,r),function(e,r){"object"===type(e)?each(e,function(e,r){return t.style[r]=e}):t.style[r]=e}),t.removeAttribute(e)}else if(":html"===e){const r=t.getAttribute(e);t.innerHTML=void 0===attributeparser(this.data,r)?"":attributeparser(this.data,r),t.removeAttribute(e)}else if(":class"===e){var i=t.getAttribute(e);each(attributeparser(this.data,i),function(e,r){if("object"===type(e))each(e,function(e,r){return e?addClass(t,r):removeClass(t,r)});else{var i="number"===type(r)?e:r;e?addClass(t,i):removeClass(t,i)}}),t.removeAttribute(e)}else if(e.startsWith("bind:")){const r=e.slice(5),i=t.getAttribute(e);"html"===r&&(t.innerHTML=void 0===attributeparser(this.data,i)?"":attributeparser(this.data,i),t.removeAttribute(e)),"show"===r&&(t.style.display=attributeparser(this.data,i)?"block":"none",t.removeAttribute(e)),"text"===r&&(t.textContent=void 0===attributeparser(this.data,i)?"":attributeparser(this.data,i),t.removeAttribute(e)),"value"===r&&(t.value=void 0===attributeparser(this.data,i)?"":attributeparser(this.data,i),t.removeAttribute(e)),"src"===r&&(t.src=attributeparser(this.data,i),t.removeAttribute(e)),"class"===r&&(each(attributeparser(this.data,i),function(e,r){if("object"===type(e))each(e,function(e,r){return e?addClass(t,r):removeClass(t,r)});else{var i="number"===type(r)?e:r;e?addClass(t,i):removeClass(t,i)}}),t.removeAttribute(e)),t[r]=attributeparser(this.data,i),t.removeAttribute(e)}else if(e.startsWith(":")){const r=e.slice(1),i=t.getAttribute(e);t[r]=attributeparser(this.data,i),t.removeAttribute(e)}else if("if"===e){const r=t.getAttribute(e);var n=document.createComment("if");attributeparser(this.data,r)?(t.innerHTML=t.innerHTML,t.removeAttribute(e)):(t.innerHTML="",t.appendChild(n),t.removeAttribute(e))}const a=document.querySelectorAll("[model]"),s=document.querySelectorAll("[bind]");let o={};for(let t of a)if("input"!==t.tagName.toLowerCase())tip("<"+t.tagName.toLowerCase()+"></"+t.tagName.toLowerCase()+">\n can't be used with this directive. \n <"+t.tagName.toLowerCase()+">");else if("text"===t.type||"number"===t.type||"password"===t.type){let e=t.getAttribute("model");t.addEventListener("keyup",r=>{o[e]=t.value}),u(e)}function u(t){if(!o.hasOwnProperty(t)){let e;Object.defineProperty(o,t,{set:r=>{e=r;for(let e of a)e.getAttribute("model")===t&&e.type&&(e.value=r);for(let e of s)e.getAttribute("bind")===t&&(e.type||(e.innerHTML=r))},get:()=>e,enumerable:!0})}}},Dative.debug=setDebug,Dative.warn=warn,Dative.importstyle=function(t){null==t&&warn("href needs a value to be a file");var e=document.createElement("link");e.href=t+".css",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)};let activeEffect=null;class Dep{constructor(){this.subscribers=new Set}depend(){activeEffect&&this.subscribers.add(activeEffect)}notify(){this.subscribers.forEach(t=>t())}}function watchEffect(t){activeEffect=t,t(),activeEffect=null}function reactive(t){return Object.keys(t).forEach(e=>{const r=new Dep;let i=t[e];Object.defineProperty(t,e,{get:()=>(r.depend(),i),set(t){t!==i&&(i=t,r.notify())}})}),t}const ref=t=>{return{current:t}};function $$emit(t,e,r,i=!0){let n;return t&&e?(n=new CustomEvent(e,{bubbles:!0,cancelable:!i,detail:r}),t.dispatchEvent(n)):warn("You did not provide an element or event name.")}Dative.version="V1.0.0",Dative.reactive=reactive,Dative.watchEffect=watchEffect,Dative.ref=ref,Dative.emit=$$emit,Dative.use=function(t){var e=arguments[1],r=[];if(r.hasOwnProperty(t))return warn(`${t} is already installed`),this;t.install&&"function"==typeof t.install&&("function"==typeof t.install&&t.install(Dative,e),"function"==typeof t&&t(Dative,e),r.push(t))};export default Dative;export{watchEffect,reactive,$$emit as emit,ref};